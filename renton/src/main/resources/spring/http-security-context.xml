<?xml version="1.0" encoding="UTF-8"?>
<bean:beans xmlns:bean="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://www.springframework.org/schema/security"
    xmlns:oauth2="http://www.springframework.org/schema/security/oauth2"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd
        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-4.2.xsd
        http://www.springframework.org/schema/security/oauth2 http://www.springframework.org/schema/security/spring-security-oauth2.xsd">

	<!-- <debug/> -->
	
	<http pattern="/lib/**" security="none" />
	<http pattern="/css/**" security="none" />
	<http pattern="/js/**" security="none" />
	
	<http pattern="/auth/oauth/token" create-session="stateless"
		authentication-manager-ref="clientAuthenticationManager"
		entry-point-ref="oauthAuthenticationEntryPoint">
		<intercept-url pattern="/auth/oauth/token" access="isAuthenticated()" />
		<anonymous enabled="false" />
		<csrf disabled="true"/>
		<http-basic entry-point-ref="oauthAuthenticationEntryPoint" />
		<custom-filter ref="clientCredentialsTokenEndpointFilter" before="BASIC_AUTH_FILTER" />
		<access-denied-handler ref="oauthAccessDeniedHandler" />
	</http>
	
    <!-- <http pattern="/web/**"
    	auto-config="true" 
    	use-expressions="true" 
    	authentication-manager-ref="webAuthenticationManager"
    	access-decision-manager-ref="affirmativeBased">
    	
    	<anonymous enabled="true"/>
    	<intercept-url pattern="/web/login" access="permitAll" />
    	<intercept-url pattern="/web/**" access="isAuthenticated()"/>
        
        <form-login 
        	login-page="/auth/login"
        	username-parameter="userId"
        	password-parameter="password" 
        	login-processing-url="/auth/doLogin" 
        	default-target-url="/web/main"/>
        	
        <logout logout-url="/web/doLogout" logout-success-url="/web/login" />

        <session-management session-fixation-protection="migrateSession">
        	<concurrency-control max-sessions="3" expired-url="/web/login" />
        </session-management>
        
        <custom-filter position="PRE_AUTH_FILTER" ref="preAuthenticationFilter"/>
    </http> -->
    
    <http pattern="/**" 
		authentication-manager-ref="authenticationManager">
    	
    	<csrf disabled="true"/>
    	<intercept-url pattern="/auth/login" access="permitAll" />
    	<intercept-url pattern="/**" access="isAuthenticated()"/>
        
        <form-login 
        	login-page="/auth/login"
        	username-parameter="userId"
        	password-parameter="password" 
        	login-processing-url="/auth/doLogin" 
        	default-target-url="/web/main"/>
        	
        <logout logout-url="/web/doLogout" logout-success-url="/web/login" />
        
        <session-management session-fixation-protection="migrateSession">
        	<concurrency-control max-sessions="3" expired-url="/web/login" />
        </session-management>
    </http>
</bean:beans>
