<?xml version="1.0" encoding="UTF-8"?>
<bean:beans xmlns:bean="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://www.springframework.org/schema/security"
    xmlns:oauth2="http://www.springframework.org/schema/security/oauth2"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd
        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-4.2.xsd
        http://www.springframework.org/schema/security/oauth2 http://www.springframework.org/schema/security/spring-security-oauth2.xsd">

	<global-method-security proxy-target-class="true" pre-post-annotations="enabled" />
    
    <authentication-manager id="webAuthenticationManager" alias="authenticationManager">
        <authentication-provider user-service-ref="userDetailsService">
        	<!-- <password-encoder ref="passwordEncoder" /> -->
        </authentication-provider>
        
        <!-- <authentication-provider ref="rentonAuthenticationProvider" /> -->
    </authentication-manager>
    
    <authentication-manager id="preAuthenticationManager" >
    	<authentication-provider ref="preAuthenticationProvider"/>
    </authentication-manager>
    
    <bean:bean id="passwordEncoder" class="org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder"/>
    
    <bean:bean id="preAuthenticationFilter" class="com.jlab.renton.main.security.RentonPreAuthenticatedProcessingFilter">
    	<bean:property name="authenticationManager" ref="preAuthenticationManager"/>
    </bean:bean>
    
    <bean:bean id="preAuthenticationProvider" class="org.springframework.security.web.authentication.preauth.PreAuthenticatedAuthenticationProvider">
    	<bean:property name="preAuthenticatedUserDetailsService" ref="authUserDetailsService"/>
    </bean:bean>
    
    <bean:bean id="affirmativeBased" class="org.springframework.security.access.vote.AffirmativeBased">
    	<bean:constructor-arg>
    		<bean:list>
    			<!-- <bean:bean class="org.springframework.security.access.vote.RoleVoter"/> -->
    			<!-- <bean:bean class="org.springframework.security.access.vote.AuthenticatedVoter"/> -->
    			<bean:bean class="org.springframework.security.web.access.expression.WebExpressionVoter" />
    			<!-- <bean:bean class="com.jlab.renton.security.RentonAccessDecisionVoter" /> -->
    		</bean:list>
    	</bean:constructor-arg>
    </bean:bean>
</bean:beans>
